<!DOCTYPE html>
<html
   prefix="dct: http://purl.org/dc/terms/
   		   foaf: http://xmlns.com/foaf/0.1/
   		   rdf: http://www.w3.org/1999/02/22-rdf-syntax-ns#
   		   xf: http://www.w3.org/2002/xforms
           xsd: http://www.w3.org/2001/XMLSchema
           xsi: http://www.w3.org/2001/XMLSchema-instance
           cc: http://creativecommons.org/ns#"
   lang="de-de"
>
    <title> SIEVE Email Regeln &middot; Alexander von Boguszewski </title>
	<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="author" content="Alexander von Boguszewski">
<meta name="robots" content="index,follow">
<meta name="revisit-after" content="5 days">
<meta name="description" content="">
<meta property="og:url" content="http://alexander.vonboguszewski.name/techdocs/sieve/">
<meta property="og:title" content="SIEVE Email Regeln">
<meta property="og:description" content="">

<link rel="stylesheet" href="http://alexander.vonboguszewski.name/css/general.css">



<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>

<script>
	
	function enc(text) {
		  var map =  "!\"#$%&'()*+,-";
			map += "./0123456789:;<=>?";
			var R = new String()
			map += "@ABCDEFGHIJKLMNOPQRSTU";
			map += "VWXYZ[\\]^_`abcdefghijklm";
			var i, j, c, len;
			map += "nopqrstuvwxyz{|}~";
		  	len = map.length;
		  	for(i = 0; i < text.length; i++) {
		  	  c = text.charAt(i)
		  	  j = map.indexOf(c)
		  	  if (j >= 0) {
		  	    c = map.charAt((j + len / 2) % len)
		  	  }
		  	  R = R + c
		  	}
		  	return R;
		}

		function toggleMe(a,b){
		  var onDiv=document.getElementById(a);
			var onLink=document.getElementById(a+"_link");
			var offDiv=document.getElementById(b);
			var offLink=document.getElementById(b+"_link");
		 	if(!onDiv || !offDiv){
				return true;
			} else {

			$(offDiv).fadeOut(1500);
			offLink.style.fontWeight="normal";
			$(onDiv).fadeIn(1500);
			onLink.style.fontWeight="bold";

		  	return true;
			}
		}
</script>

 
	<script type="application/ld+json">
		{
		  "@context": "http://schema.org",
		  "@type": "BlogPosting",
  		   "headline": "SIEVE Email Regeln",
 			"url" : "http://alexander.vonboguszewski.name/techdocs/sieve/",
  			"author": {
    			"@type": "Person",
  				"name" : "Alexander von Boguszewski", 
  				"url" : "http://alexander.vonboguszewski.name/"
  			  },
  			  "publisher": {
    			"@type": "Organization",
  				"name" : "Alexander von Boguszewski Personal Webpage" ,
  				"logo": {
     				 "@type": "ImageObject",
      				 "url": "http://alexander.vonboguszewski.name//images/bg.png"
   				 }
  			  },
  			  "mainEntityOfPage": {
        		 "@type": "WebPage",
       			 "@id": "http://alexander.vonboguszewski.name/"
    		  }
  			
  			, "dateModified": "2015-11-12T00:00:00&#43;00:00"
  			, "datePublished": "2015-11-12T00:00:00&#43;00:00"
  			, "keywords": "admin,analytics,bigdata,bw5,db,integration,programming,bw5,bw6,bwce,datafabric,db,hawk,java,mail,rsync,spotfire,talend,tibco,tos,"
		}
		</script>

		        
    </head>
	<body class="avb-light">
		
		<nav class="avb-sidebar avb-bar-block avb-small avb-hide-small avb-center">
		  
		  <br>
	      <img src="http://alexander.vonboguszewski.name//images/bg.png" alt="Alexander von Boguszewski" style="width:100%">
		  <a href="http://alexander.vonboguszewski.name/" class="avb-bar-item avb-button avb-padding-large avb-hover-ambient">
		    <p>&lt;&lt;HOME</p>
		  </a>
		  <a href="http://alexander.vonboguszewski.name//techdocs/" class="avb-bar-item avb-button avb-padding-large avb-hover-ambient">
		    <p>&lt;TechDocs</p>
		  </a>
		</nav>
		
		<div class="avb-top avb-hide-large avb-hide-medium" id="myNavbar">
		  <div class="avb-bar avb-light avb-opacity avb-hover-opacity-off avb-center avb-small">
		  	  
		    <a href="http://alexander.vonboguszewski.name/" class="avb-bar-item avb-button" style="width:25% !important">&lt;&lt;HOME</a>
		    <a href="http://alexander.vonboguszewski.name//techdocs/" class="avb-bar-item avb-button" style="width:25% !important">&lt;TechDocs</a>
		  </div>
		</div>
		
		<div class="avb-padding-large" id="main">
		  
		  <header class="avb-container avb-padding-medium avb-center avb-light" id="home">
		  		<br>
	  			<p class="avb-large font-weight: bold;">Alexander von Boguszewski</p>
		  		<h1 class="avb-jumbo font-weight: bold;">SIEVE Email Regeln</h1>
		    	<p class="avb-text-normal"></p>
		    </header>
	  		<div class="avb-content avb-text-normal avb-padding-medium" id="content">
	  			<span class="post-date">Nov 12, 2015 </span>
	  			<hr style="width:200px" class="avb-opacity">
                

<p>Mit SIEVE können Emails serverseitig auf IMAP-Servern verarbeitet werden. Mit der sieveshell können die Skripte auf den Server geladen werden.
Es kann immer nur ein Skript aktiviert sein.</p>

<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">sieveshell –user<span style="color:#f92672">=</span>hdab –a hdab localhost
put myscript.sieve
activate myscript.sieve</code></pre></div>

<h2 id="syntax">Syntax</h2>

<h3 id="kommentare">Kommentare</h3>

<p>Kommentarzeilen beginnen mit &ldquo;#&rdquo;.</p>

<h3 id="zahlen">Zahlen</h3>

<p>Nur positive Ganzzahlen sind erlaubt. Größen können über  &ldquo;K&rdquo; , &ldquo;M&rdquo; und &ldquo;G&rdquo;  für Kilobytes, Megabytes und Gigabytes angegeben werden.</p>

<h3 id="strings">Strings</h3>

<p>Strings werden durch &ldquo; eingeleitet. Das Escapezeichen ist . String-Listen werden mit &ldquo;[&rdquo; eingeleitet und mit &ldquo;]&rdquo; abgeschlossen.</p>

<h3 id="kontrollstrukturen">Kontrollstrukturen</h3>

<p>Sieve ermöglicht Wenn-Dann Konstrukte mit:
* if
* elsif
* else</p>

<p>Ein if leitet eine bedingte Anweisung ein. Nur wenn die zu testende Bedingung zutrifft, wird der nachfolgende Codeblock ausgeführt. Wenn nicht, dann können weitere Bedingungen mittels elsif abgefragt werden. Falls keine der Bedingungen aus den &ldquo;if&rdquo;- und &ldquo;elsif&rdquo;-Blöcken zutrifft, werden die Anweisungen des &ldquo;else&rdquo;-Blocks abgearbeitet, sofern vorhanden.</p>

<h3 id="vergleiche-von-zeichenketten">Vergleiche von Zeichenketten</h3>

<p>Es bestehen mehrere Vergleichsoperationen für Strings:
* :contains prüft, ob eine bestimmte Zeichenkette in einem anderen String enthalten ist.
* :is führt einen exakten Vergleich durch, d.h. die Inhalte der verglichenen Zeichenketten müssen exakt übereinstimmen.
* :matches beinhaltet eine Möglichkeit, beim Vergleich Teile einer Zeichenkette ungeprüft zu belassen. Mit dem Symbol * können mehrere, mit dem Symbol ? genau ein Zeichen freigestellt werden. So wird beispielsweise G?n alle dreibuchstabigen Wörter mit einem großen G am Anfang und einem kleinen n am Ende finden, während G*n alle Wörter von Gin über Gasmann bis hin zu Gesundheitskartenevaluierungskommission und darüber hinaus adressieren wird.</p>

<h3 id="adressen-matching">Adressen-Matching</h3>

<p>E-Mail-Adressen mit dem Keyword address geprüft werden. Natürlich ist es möglich, die Absender- oder die Empfängeradresse zu prüfen. Dabei wird generell nur auf die eigentliche Adresse verglichen, also alles was zwischen den spitzen Klammern geschrieben steht. Um den kompletten String zu vergleichen, sollte man auf Name &ldquo;&lt;&rdquo; Adresse &ldquo;&gt;&rdquo; prüfen. Die Anführungszeichen kennzeichnen hierbei Strings. Um Adressen auf den Teil vor dem @ oder nach dem @ zu prüfen, können die optionalen Argumente :localpart bzw. :domain genutzt werden. Standardmäßig wird die komplette Adresse geprüft (entspricht :all).
Größenvergleiche
Die Größe einer Mail prüft man mit dem Keyword size. Vergleiche mit Zahlen kann man mit den Operatoren :over bzw. :under durchführen.
Header-Felder
Header können mit dem Keyword header geprüft werden. Header-Felder können ganz normal mit den oben beschriebenen Zeichenketten-Vergleichen durchsucht werden. Es ist darauf zu achten, dass der Doppelpunkt nicht verwendet wird.
Blöcke
Um nach einem Test mehrere Anweisungen auszuführen können Blöcke mit {} gebildet werden.
Anweisungen
Wenn eine Regel matcht können folgende Anweisungen ausgeführt werden:
* stop Beendet die Ausführung. Falls keine Regel zugetroffen hat, wird die Nachricht in der INBOX belassen (Impliziertes keep)
* keep Speichert die Nachricht in der INBOX
* redirect Weiterleiten einer Nachricht. Als Argument wird eine E-Mail-Adresse angegeben.
* discard Löscht die Nachricht. Der Absender erhält davon keine Nachricht.
* reject Diese Anweisung sorgt dafür, dass die Nachricht abgelehnt wird. Optional kann man einen Grund für die Ablehnung angeben. Es wird eine sogenannte &ldquo;Message Delivery Notification&rdquo; erstellt. Falls man &ldquo;reject&rdquo; nutzen will, muss man dies über den &ldquo;require reject&rdquo; am Anfang des Scriptes anfordern.
* fileinto Die Nachricht kann in einen bestimmten Ordner verschoben werden. Dazu muss als Argument der Folder in der für den Server spezifischen Form angegeben werden. Will man &ldquo;fileinto&rdquo; nutzen, muss man es als erstes über den &ldquo;require&rdquo; anfordern.</p>

<h2 id="beispielskript">Beispielskript</h2>

<p><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">require [&#34;fileinto&#34;, &#34;reject&#34;];

# Nachrichten größer 100K werden abgewiesen mit einer Fehlermeldung
#

if size :over 100K {
   reject &#34;Die Datei war groesser als 100k. Bitte kleinere Datein schicken.&#34;;
}

# Ein Mailing von vonboguszewski.name soll in einen Ordner verschoben # werden
#

elsif address :is [&#34;From&#34;, &#34;To&#34;] &#34;mailinglist@vonboguszewski.name&#34; {
   fileinto &#34;INBOX.vonboguszewski&#34;;
}

# Spam Regel: Nachricht enthält meine Adresse nicht im To, CC oder Bcc
# header, oder Subject ist irgendwas mit &#34;money&#34; bzw. &#34;Viagra&#34;.
#

elsif anyof (not address :all :contains [&#34;To&#34;, &#34;Cc&#34;, &#34;Bcc&#34;] &#34;me@blafasel.invalid&#34;, 
header :matches &#34;Subject&#34; [&#34;*money*&#34;,&#34;*Viagra*&#34;])
      fileinto &#34;INBOX.spam&#34;;


# Alle anderen Mails behalten wir. 
# Diese Regel wäre nicht nötig, da durch das &#34;implicit keep&#34; 
# bereits abgedeckt.

else {
     keep;
}</code></pre></div></p>

            </div>
            <hr style="width:200px" class="avb-opacity">
        	<div id="footer" style="font-size:small;">
<span property="dct:title"><a property="cc:attributionName" rel="license" href="http://creativecommons.org/licenses/by-sa/4.0/">Lizensiert unter einer Creative Commons Lizent - Weitergabe unter gleichen Bedingungen</a></span>
| <a href="/imprint/">Impressum</a>
</div>
        </div>
	</body>
</html>
